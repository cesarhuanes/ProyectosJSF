<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich" xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets">
<a4j:keepAlive beanName="pagosTransferController" />
<a4j:keepAlive beanName="procesoPagos" />

<head>

</head>
<body>
	<rich:panel id="pnlModulo" height="100%">
		<f:facet name="header">
			<h:outputText value="Tesorería > Pagos Transferencias entre Cuentas">
			</h:outputText>
		</f:facet>
		<h:form id="formPagos">



			<fieldset>
				<legend>Parametros Generales</legend>
				<table border="0px" style="border-collapse: collapse; width: 794px;">
					<tr>
						<td><h:outputText style="font-size:11px;" value="Fec. Transaccion :" /></td>
						<td><rich:calendar id="idFechaTransaccion" enableManualInput="false" datePattern="yyyy-MM-dd"
								value="#{pagosTransferController.fecTransaccion}" required="true" requiredMessage="Obligatorio" immediate="true" reRender="formPagos">
								<a4j:support event="onchanged" reRender="idEuroSoles,idDolarSoles,idEurosDolares,idFechaPago,btnProcesar"
									action="#{pagosTransferController.actualizarTiposCambio}" />
							</rich:calendar> <rich:message for="idFechaTransaccion" style="color: red;">
								<f:facet name="errorMarker">
									<h:graphicImage url="../imagenes/error.png" />
								</f:facet>
							</rich:message></td>

						<td><h:outputText style="font-size:11px;" value="Medio de Pago:" /></td>
						<td><h:selectOneMenu id="medioPago" value="#{pagosTransferController.idMedioPago}" requiredMessage="Obligatorio" reRender="formPagos">
								<f:selectItems value="#{pagosTransferController.medioPagoItems}" />
							</h:selectOneMenu> <rich:message for="medioPago" style="color:RED;">
								<f:facet name="errorMarker">
									<h:graphicImage url="../imagenes/error.png" />
								</f:facet>
							</rich:message></td>



					</tr>
					<tr>

					</tr>
					<tr>
						<td><h:outputText style="font-size:11px;" value="Fec. Pago" /></td>
						<td colspan="1"><rich:calendar id="idFechaPago" enableManualInput="true" datePattern="yyyy-MM-dd"
								value="#{pagosTransferController.fecPago}" required="true" requiredMessage="Obligatorio" immediate="true" reRender="formPagos" readonly="true"
								style="background:#ddd;">
							</rich:calendar> <rich:message for="idFechaPago" style="color: red;">
								<f:facet name="errorMarker">
									<h:graphicImage url="../imagenes/error.png" />
								</f:facet>
							</rich:message></td>

						<td></td>
					</tr>
				</table>
			</fieldset>

			<fieldset>
				<legend>Tipo de Cambio del Dia</legend>
				<table>
					<tr>
						<td><h:outputText value="EUR-PEN" /></td>
						<td><h:inputText id="idEuroSoles" maxlength="4" value="#{pagosTransferController.valEuroSoles}" style="background:#ddd;" readonly="true" /></td>
						<td><h:outputText value="USD-PEN" /></td>
						<td><h:inputText id="idDolarSoles" maxlength="6" value="#{pagosTransferController.valDolarSoles}" style="background:#ddd;" readonly="true" /></td>
						<td><h:outputText value="EUR-USD" /></td>
						<td><h:inputText id="idEurosDolares" maxlength="6" value="#{pagosTransferController.valEuroDolares}" style="background:#ddd;"
								readonly="true" /></td>
					</tr>
				</table>
			</fieldset>


			<fieldset>
				<legend>Parametros por cuenta</legend>
				<table border="0px" style="border-collapse: collapse; width: 797px;">
					<tr>
						<td><h:outputText style="font-size:11px;" value="Cuenta Origen:" /></td>
						<td><h:selectOneMenu id="tipoCtaBanco1" value="#{pagosTransferController.numCuentaBanco1}" required="false" requiredMessage="Obligatorio"
								immediate="true" reRender="formPagos">
								<f:selectItems value="#{pagosTransferController.listaCtaBanco}" />
							</h:selectOneMenu> <rich:message for="tipoCtaBanco1" style="color:RED;">
								<f:facet name="errorMarker">
									<h:graphicImage url="../imagenes/error.png" />
								</f:facet>
							</rich:message></td>

						<td><h:outputText style="font-size:11px;" value="Cuenta Destino:" /></td>
						<td><h:selectOneMenu id="tipoCtaBanco2" value="#{pagosTransferController.numCuentaBanco2}" required="false" requiredMessage="Obligatorio"
								immediate="true" reRender="formPagos">
								<f:selectItems value="#{pagosTransferController.listaCtaBanco}" />
							</h:selectOneMenu> <rich:message for="tipoCtaBanco2" style="color:RED;">
								<f:facet name="errorMarker">
									<h:graphicImage url="../imagenes/error.png" />
								</f:facet>
							</rich:message></td>

					</tr>
					<tr>

					</tr>
					<tr>
						<td><h:outputText style="font-size:11px;" value="Monto Origen:" /></td>
						<td colspan="1"><h:inputText id="montoA" maxlength="50" value="#{pagosTransferController.montoA}" style=" width : 116px;" /></td>
						<td><h:outputText style="font-size:11px;" value="Monto Destino: " /></td>
						<td><h:inputText id="montoB" maxlength="100" value="#{pagosTransferController.montoB}" style=" width : 116px;"></h:inputText></td>
					</tr>

					<tr>
						<td><h:outputText style="font-size:11px;" value="Referencia Origen:" /></td>
						<td colspan="1"><h:inputText id="refA" maxlength="50" value="#{pagosTransferController.refA}" style=" width : 123px;" /></td>
						<td><h:outputText style="font-size:11px;" value="Referencia Destino: " /></td>
						<td><h:inputText id="refB" maxlength="100" value="#{pagosTransferController.refB}" style=" width : 125px;"></h:inputText></td>
					</tr>

				</table>
			</fieldset>

			<div align="right">

				<div>

					<a4j:commandButton id="btnProcesar" action="#{pagosTransferController.obtenerAsiento}" style="width:125px"
						disabled="#{pagosTransferController.desabBtnProcesarAsientos}" value="Procesar Asientos" reRender="listaAsiento,btnEnviar" />
				</div>

				<fieldset id="idTable">
					<legend>Asientos Contables Generados</legend>
					<!-- Aqui va la tabla -->
					<div align="right">
						<h:outputText value="TIPO DE DIARIO : " />
						<h:outputText value="#{pagosTransferController.tipoDiario}" />
					</div>
					<div style="scrollbar-base-color: #3d8a3d; width: 1100px; border: 0px solid white; overflow-x: scroll; height: 190px;">
						<rich:extendedDataTable id="listaAsiento" rowKeyVar="rkv" frozenColCount="1" height="100px" width="1500px" columnClasses="col" var="proc"
							headerClass="col" value="#{pagosTransferController.resultadoContable}" selectionMode="single">

							<rich:column id="tipoCuenta" headerClass="dataTableHeader" sortable="true" sortBy="#{proc.codigoCuenta}">
								<f:facet name="header">
									<h:outputText value="Cuenta Contable" />
								</f:facet>
								<center>
									<h:outputText value="#{proc.cuentaContable}" />
								</center>
							</rich:column>
							<!-- 
			<rich:column id="nombreLibro" headerClass="dataTableHeader" 
				sortable="true" sortBy="#{proc.nombreLibro}"
				
				>
				<f:facet name="header">
					<h:outputText value="Libro" />
				</f:facet>
				<center>
					<h:outputText value="#{proc.nombreLibro}" />
				</center>
			</rich:column> -->

							<rich:column id="fecha" headerClass="dataTableHeader" sortable="true" sortBy="#{proc.fecha}">
								<f:facet name="header">
									<h:outputText value="Fecha Transaccion" />
								</f:facet>
								<center>
									<h:outputText value="#{proc.fecha}">
										<f:convertDateTime pattern="dd/MM/yyyy" />
									</h:outputText>
								</center>
							</rich:column>

							<rich:column id="periodo" headerClass="dataTableHeader" sortable="true" sortBy="#{proc.periodo}">
								<f:facet name="header">
									<h:outputText value="Periodo" />
								</f:facet>
								<center>
									<h:outputText value="#{proc.periodo}" />
								</center>
							</rich:column>
							<rich:column id="glosa" headerClass="dataTableHeader" sortable="true" sortBy="#{proc.glosa}" width="400px">
								<f:facet name="header">
									<h:outputText value="Glosa" />
								</f:facet>
								<center>
									<h:outputText value="#{proc.glosa}" />
								</center>
							</rich:column>

							<rich:column id="referencia" headerClass="dataTableHeader" sortable="true" sortBy="#{proc.referencia}">
								<f:facet name="header">
									<h:outputText value="Referencia" />
								</f:facet>
								<center>
									<h:outputText value="#{proc.referencia}" />
								</center>
							</rich:column>

							<rich:column id="importeSoles" headerClass="dataTableHeader" sortable="true" sortBy="#{proc.importeSoles}">
								<f:facet name="header">
									<h:outputText value="Importe Soles" />
								</f:facet>
								<center>
									<h:outputText value="#{proc.importeSoles}" style="float:right">
										<f:convertNumber locale="en_US" />
									</h:outputText>
								</center>
							</rich:column>
							<rich:column id="marcadorDC" headerClass="dataTableHeader" sortable="true" sortBy="#{proc.marcadorDC}" width="50px">
								<f:facet name="header">
									<h:outputText value="D/C" />
								</f:facet>
								<center>
									<h:outputText value="#{proc.marcadorDC}" />
								</center>
							</rich:column>
							<rich:column id="moneda" headerClass="dataTableHeader" sortable="true" sortBy="#{proc.moneda}" width="50px">
								<f:facet name="header">
									<h:outputText value="Moneda" />
								</f:facet>
								<center>
									<h:outputText value="#{proc.moneda}" />
								</center>
							</rich:column>
							<rich:column id="importeTransaccion" headerClass="dataTableHeader" sortable="true" sortBy="#{proc.importeTransaccion}">
								<f:facet name="header">
									<h:outputText value="Importe Transacción" />
								</f:facet>
								<center>
									<h:outputText value="#{proc.importeTransaccion}" style="float:right">
										<f:convertNumber locale="en_US" />
									</h:outputText>
								</center>
							</rich:column>

							<rich:column id="importeEuros" headerClass="dataTableHeader" sortable="true" sortBy="#{proc.referencia}">
								<f:facet name="header">
									<h:outputText value="Importe Euros" />
								</f:facet>
								<center>
									<h:outputText value="#{proc.importeEuros}" style="float:right">
										<f:convertNumber locale="en_US" />
									</h:outputText>
								</center>
							</rich:column>
							<!-- <rich:column id="centroCosto" headerClass="dataTableHeader" 
				sortable="true" sortBy="#{proc.referencia}"
				
				>
				<f:facet name="header">
					<h:outputText value="Centro de Costos" />
				</f:facet>
				<center>
					<h:outputText value="#{proc.centroCosto}" />
				</center>
			</rich:column> -->
							<!--<rich:column id="socioProducto" headerClass="dataTableHeader" 
				sortable="true" sortBy="#{proc.socioProducto}"
				
				>
				<f:facet name="header">
					<h:outputText value="Socio producto" />
				</f:facet>
				<center>
					<h:outputText value="#{proc.socioProducto}" />
				</center>
			</rich:column>
			 <rich:column id="canal" headerClass="dataTableHeader" 
				sortable="true" sortBy="#{proc.canal}"
				
				>
				<f:facet name="header">
					<h:outputText value="Canal" />
				</f:facet>
				<center>
					<h:outputText value="#{proc.canal}" />
				</center>
			</rich:column> -->
							<!-- <rich:column id="proveedorEmpleado" headerClass="dataTableHeader" 
				sortable="true" sortBy="#{proc.proveedorEmpleado}"
				
				>
				<f:facet name="header">
					<h:outputText value="Proveedor / Empleado" />
				</f:facet>
				<center>
					<h:outputText value="#{proc.proveedorEmpleado}" />
				</center>
			</rich:column>
			<rich:column id="rucDniCliente" headerClass="dataTableHeader" 
				sortable="true" sortBy="#{proc.rucDniCliente}"
				
				>
				<f:facet name="header">
					<h:outputText value="RUC/DNI Cliente" />
				</f:facet>
				<center>
					<h:outputText value="#{proc.rucDniCliente}" />
				</center>
			</rich:column>
			<rich:column id="polizaCliente" headerClass="dataTableHeader" 
				sortable="true" sortBy="#{proc.polizaCliente}"
				
				>
				<f:facet name="header">
					<h:outputText value="Poliza del Cliente" />
				</f:facet>
				<center>
					<h:outputText value="#{proc.polizaCliente}" />
				</center>
			</rich:column>
			<rich:column id="inversiones" headerClass="dataTableHeader" 
				sortable="true" sortBy="#{proc.inversiones}"
				
				>
				<f:facet name="header">
					<h:outputText value="Inversiones" />
				</f:facet>
				<center>
					<h:outputText value="#{proc.inversiones}" />
				</center>
			</rich:column>
			<rich:column id="nroSiniestro" headerClass="dataTableHeader" 
				sortable="true" sortBy="#{proc.nroSiniestro}"
				
				>
				<f:facet name="header">
					<h:outputText value="Nro de Siniestro" />
				</f:facet>
				<center>
					<h:outputText value="#{proc.nroSiniestro}" />
				</center>
			</rich:column>-->

							<rich:column id="tipoMedioPago" headerClass="dataTableHeader" sortable="true" sortBy="#{proc.tipoMedioPago}">
								<f:facet name="header">
									<h:outputText value="Tipo de medio de Pago" />
								</f:facet>
								<center>
									<h:outputText value="#{proc.tipoMedioPago}" />
								</center>
							</rich:column>
							<rich:column id="fechaVencimiento" headerClass="dataTableHeader" sortable="true" sortBy="#{proc.fechaVencimiento}">
								<f:facet name="header">
									<h:outputText value="Fecha Vencimiento" />
								</f:facet>
								<center>
									<h:outputText value="#{proc.fechaVencimiento}">
										<f:convertDateTime pattern="dd/MM/yyyy" />
									</h:outputText>
								</center>
							</rich:column>
							<!-- <rich:column id="codActivoFijo" headerClass="dataTableHeader" 
				sortable="true" sortBy="#{proc.codActivoFijo}"
				
				>
				<f:facet name="header">
					<h:outputText value="Cod Activo Fijo" />
				</f:facet>
				<center>
					<h:outputText value="#{proc.codActivoFijo}" />
				</center>
			</rich:column>
			<rich:column id="indicador" headerClass="dataTableHeader" 
				sortable="true" sortBy="#{proc.indicador}"
				
				>
				<f:facet name="header">
					<h:outputText value="Indicador (I/V/D)" />
				</f:facet>
				<center>
					<h:outputText value="#{proc.indicador}" />
				</center>
			</rich:column> -->

							<!-- 
			<rich:column id="nroConstancia" headerClass="dataTableHeader" 
				sortable="true" sortBy="#{proc.nroConstancia}"
				
				>
				<f:facet name="header">
					<h:outputText value="dd" />
				</f:facet>
				<center>
					<h:outputText value="#{proc.nroConstancia}" />
				</center>
			</rich:column>
			 -->
							<!--<rich:column id="marcador" headerClass="dataTableHeader" 
				sortable="true" sortBy="#{proc.marcador}"
				
				>
				<f:facet name="header">
					<h:outputText value="Marcador" />
				</f:facet>
				<center>
					<h:outputText value="#{proc.marcador}" />
				</center>
			</rich:column>
			
			<rich:column id="refImpSoles" headerClass="dataTableHeader" 
				sortable="true" sortBy="#{proc.refImpSoles}"
				
				>
				<f:facet name="header">
					<h:outputText value="Referencia Importe Soles" />
				</f:facet>
				<center>
					<h:outputText value="#{proc.refImpSoles}" />
				</center>
			</rich:column>
			<rich:column id="refImpTrans" headerClass="dataTableHeader" 
				sortable="true" sortBy="#{proc.refImpTrans}"
				
				>
				<f:facet name="header">
					<h:outputText value="Referencia Importe Transaccion" />
				</f:facet>
				<center>
					<h:outputText value="#{proc.refImpTrans}" />
				</center>
			</rich:column>
			<rich:column id="refImpEuros" headerClass="dataTableHeader" 
				sortable="true" sortBy="#{proc.referencia}"
				
				>
				<f:facet name="header">
					<h:outputText value="Referencia Importe Euros" />
				</f:facet>
				<center>
					<h:outputText value="#{proc.refImpEuros}" />
				</center>
			</rich:column>
          -->
						</rich:extendedDataTable>
					</div>
					<div align="right">

						<a4j:commandButton id="btnEnviar" action="#{pagosTransferController.enviarPagoSun}" style="width:125px"
							reRender="panelAsientoContable,listaCorrectosAsientoContable
								,formAsientos,listaErroresAsientoContable,listaAsiento,
								tipoCtaBanco1,tipoCtaBanco2,montoA,montoB,refA,refB,dc1,dc2"
							value="Enviar SUN" onclick="Richfaces.showModalPanel('ajaxLoadingModalBox')" oncomplete="Richfaces.showModalPanel('panelAsientoContable')"
							disabled="#{pagosTransferController.desabBtnEnvioSun}" />
					</div>
					<!-- <rich:datascroller align="center" for="listaAsientoContable"  /> -->
				</fieldset>
			</div>
		</h:form>
	</rich:panel>

	<rich:modalPanel id="ajaxLoadingModalBox" width="100" height="95">
		<center>
			<img src="#{facesContext.externalContext.requestContextPath}/imagenes/loading.gif"></img><br />
			<h:outputText value="Cargando..." />
		</center>
	</rich:modalPanel>
	<!-- <rich:messages></rich:messages> -->

	<rich:modalPanel id="panelAsientoContable" autosized="true">
		<f:facet name="controls">
			<h:panelGroup>
				<h:graphicImage value="/imagenes/close.gif" styleClass="hidelink" id="hidelink" />
				<rich:componentControl for="panelAsientoContable" attachTo="hidelink" operation="hide" event="onclick"
					action="#{rich:component('panelAsientoContable')}.hide()" />

			</h:panelGroup>
		</f:facet>
		<h:form id="formAsientos">
			<fieldset id="fieldsetAsientos">
				<legend>
					<h:outputText value="#{pagosTransferController.outText}" />
				</legend>
				<!-- Aqui va la tabla -->

				<rich:extendedDataTable id="listaCorrectosAsientoContable" rowKeyVar="rkv" frozenColCount="1" height="400px" width="1200px" columnClasses="col"
					var="proc" value="#{pagosTransferController.resultadoCorrectosContable}" selectionMode="single" rendered="#{pagosTransferController.success}">

					<rich:column id="tipoCuenta" headerClass="dataTableHeader" width="15%" sortable="true" sortBy="#{proc.diario}">
						<f:facet name="header">
							<h:outputText value="JournalLineNumber" />
						</f:facet>
						<center>
							<h:outputText value="#{proc.diario}" />
						</center>
					</rich:column>

					<rich:column id="lineaDiario" headerClass="dataTableHeader" width="15%" sortable="true" sortBy="#{proc.lineaDiario}">
						<f:facet name="header">
							<h:outputText value="JournalNumber" />
						</f:facet>
						<center>
							<h:outputText value="#{proc.lineaDiario}" />
						</center>
					</rich:column>

					<rich:column id="lineaAsientoError" headerClass="dataTableHeader" width="15%">
						<f:facet name="header">
							<h:outputText value="Asiento Enviado" />
						</f:facet>
						<center>
							<h:outputText value="#{proc.lineaAsientoError}" />
						</center>
					</rich:column>

				</rich:extendedDataTable>




				<rich:extendedDataTable id="listaErroresAsientoContable" rowKeyVar="rkv" frozenColCount="1" height="400px" width="1200px" columnClasses="col"
					var="proc" value="#{pagosTransferController.resultadoErroresContable}" selectionMode="single" rendered="#{!pagosTransferController.success}">

					<rich:column id="tipoCuenta" headerClass="dataTableHeader" width="15%" sortable="true" sortBy="#{proc.lineaAsientoError}">
						<f:facet name="header">
							<h:outputText value="Asiento Contable" />
						</f:facet>
						<center>
							<h:outputText value="#{proc.lineaAsientoError}" style="color : red" />
						</center>
					</rich:column>

					<rich:column id="lineaDiario" headerClass="dataTableHeader" width="15%" sortable="true" sortBy="#{proc.lineaDiario}">
						<f:facet name="header">
							<h:outputText value="Linea de Diario" />
						</f:facet>
						<center>
							<h:outputText value="#{proc.lineaDiario}" style="color : red" />
						</center>
					</rich:column>

					<rich:column id="nombreLibro" headerClass="dataTableHeader" width="50%" sortable="true" sortBy="#{proc.mensajeAsientoError}">
						<f:facet name="header">
							<h:outputText value="Mensaje de Error Asociado" />
						</f:facet>
						<center>
							<h:outputText value="#{proc.mensajeAsientoError}" style="color : red" />
						</center>
					</rich:column>
					<rich:column id="procedenciaError" headerClass="dataTableHeader" width="20%" sortable="true" sortBy="#{proc.procedenciaError}">
						<f:facet name="header">
							<h:outputText value="Origen del Error" />
						</f:facet>
						<center>
							<h:outputText value="#{proc.procedenciaError}" style="color : red" />
						</center>
					</rich:column>
					<rich:column id="lineaAsientoError" headerClass="dataTableHeader" width="15%">
						<f:facet name="header">
							<h:outputText value="Asiento Erróneo" />
						</f:facet>
						<center>
							<h:outputText value="#{proc.lineaAsientoError}" />
						</center>
					</rich:column>
				</rich:extendedDataTable>
			</fieldset>
		</h:form>
	</rich:modalPanel>

</body>
</html>